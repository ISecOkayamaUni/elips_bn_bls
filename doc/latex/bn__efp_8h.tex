\hypertarget{bn__efp_8h}{}\section{include/\+E\+Li\+P\+S\+\_\+bn\+\_\+bls/bn\+\_\+efp.h File Reference}
\label{bn__efp_8h}\index{include/\+E\+Li\+P\+S\+\_\+bn\+\_\+bls/bn\+\_\+efp.\+h@{include/\+E\+Li\+P\+S\+\_\+bn\+\_\+bls/bn\+\_\+efp.\+h}}
{\ttfamily \#include $<$E\+Li\+P\+S\+\_\+bn\+\_\+bls/curve\+\_\+dtypes.\+h$>$}\newline
Include dependency graph for bn\+\_\+efp.\+h\+:
% FIG 0
This graph shows which files directly or indirectly include this file\+:
% FIG 1
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{bn__efp_8h_a2b1c0fe61a09134e31640f1565a48ed1}{E\+Fp\+\_\+init} (\hyperlink{struct_e_fp}{E\+Fp} $\ast$P)
\item 
void \hyperlink{bn__efp_8h_a8d12aae9ceed0cf06fffc1dc2c2aae40}{E\+Fp\+\_\+clear} (\hyperlink{struct_e_fp}{E\+Fp} $\ast$P)
\item 
void \hyperlink{bn__efp_8h_ace55a465b090ba75133b027626fb58e9}{E\+Fp\+\_\+printf} (\hyperlink{struct_e_fp}{E\+Fp} $\ast$P, char $\ast$str)
\item 
void \hyperlink{bn__efp_8h_abb438750cc5bfec2da8cd2f3863a985f}{E\+Fp\+\_\+set} (\hyperlink{struct_e_fp}{E\+Fp} $\ast$A\+NS, \hyperlink{struct_e_fp}{E\+Fp} $\ast$P)
\item 
void \hyperlink{bn__efp_8h_a20e5f75e7bf655defd447099e8bbc3e5}{E\+Fp\+\_\+set\+\_\+ui} (\hyperlink{struct_e_fp}{E\+Fp} $\ast$A\+NS, unsigned long int UI)
\item 
void \hyperlink{bn__efp_8h_a9a4499bd470e37678fe8558f0ea81e91}{E\+Fp\+\_\+set\+\_\+mpz} (\hyperlink{struct_e_fp}{E\+Fp} $\ast$A\+NS, mpz\+\_\+t A)
\item 
void \hyperlink{bn__efp_8h_abdf2bfc544a61322457518297de393c4}{E\+Fp\+\_\+set\+\_\+neg} (\hyperlink{struct_e_fp}{E\+Fp} $\ast$A\+NS, \hyperlink{struct_e_fp}{E\+Fp} $\ast$P)
\item 
void \hyperlink{bn__efp_8h_a22397c097b95b8869032b55963d7ff2e}{E\+Fp\+\_\+rational\+\_\+point\+\_\+bn} (\hyperlink{struct_e_fp}{E\+Fp} $\ast$P)
\item 
void \hyperlink{bn__efp_8h_a131fa3538790c33f2006d84b4a60f4e5}{E\+Fp\+\_\+rational\+\_\+point\+\_\+bls12} (\hyperlink{struct_e_fp}{E\+Fp} $\ast$P)
\item 
void \hyperlink{bn__efp_8h_a9ba98cee075d39257ea190cbe340dec5}{E\+Fp\+\_\+\+E\+CD} (\hyperlink{struct_e_fp}{E\+Fp} $\ast$A\+NS, \hyperlink{struct_e_fp}{E\+Fp} $\ast$P)
\item 
void \hyperlink{bn__efp_8h_a4b290a91bf913cf38dffee13f1db784b}{E\+Fp\+\_\+\+E\+CA} (\hyperlink{struct_e_fp}{E\+Fp} $\ast$A\+NS, \hyperlink{struct_e_fp}{E\+Fp} $\ast$P1, \hyperlink{struct_e_fp}{E\+Fp} $\ast$P2)
\item 
void \hyperlink{bn__efp_8h_a39968088354e07b3bff879ea6ce7eea3}{E\+Fp\+\_\+\+S\+CM} (\hyperlink{struct_e_fp}{E\+Fp} $\ast$A\+NS, \hyperlink{struct_e_fp}{E\+Fp} $\ast$P, mpz\+\_\+t scalar)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Interaface for ellipti cuve operation in BN and B\+L\+S12 curve 

\subsection{Function Documentation}
\mbox{\Hypertarget{bn__efp_8h_a8d12aae9ceed0cf06fffc1dc2c2aae40}\label{bn__efp_8h_a8d12aae9ceed0cf06fffc1dc2c2aae40}} 
\index{bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}!E\+Fp\+\_\+clear@{E\+Fp\+\_\+clear}}
\index{E\+Fp\+\_\+clear@{E\+Fp\+\_\+clear}!bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}}
\subsubsection{\texorpdfstring{E\+Fp\+\_\+clear()}{EFp\_clear()}}
{\footnotesize\ttfamily void E\+Fp\+\_\+clear (\begin{DoxyParamCaption}\item[{\hyperlink{struct_e_fp}{E\+Fp} $\ast$}]{P }\end{DoxyParamCaption})}

clear of memory an \hyperlink{struct_e_fp}{E\+Fp} type structure


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P} & -\/ input P in \hyperlink{struct_e_fp}{E\+Fp}. \\
\hline
\end{DoxyParams}


Referenced by bls12\+\_\+2split\+\_\+\+G1\+\_\+scm(), bls12\+\_\+f\+\_\+ltp\+\_\+vtp\+\_\+for\+\_\+tate(), bls12\+\_\+ff\+\_\+ltt\+\_\+vtt\+\_\+for\+\_\+tate(), bls12\+\_\+generate\+\_\+\+G1\+\_\+point(), bls12\+\_\+\+Miller\+\_\+algo\+\_\+for\+\_\+opt\+\_\+ate(), bls12\+\_\+\+Miller\+\_\+algo\+\_\+for\+\_\+plain\+\_\+ate(), bls12\+\_\+\+Miller\+\_\+algo\+\_\+for\+\_\+tate(), bls12\+\_\+plain\+\_\+\+G1\+\_\+scm(), bls12\+\_\+\+Pseudo\+\_\+8\+\_\+sparse\+\_\+mapping(), E\+Fp\+\_\+\+E\+C\+A(), E\+Fp\+\_\+\+E\+C\+D(), and E\+Fp\+\_\+\+S\+C\+M().


\begin{DoxyCode}
37                       \{
38     Fp\_clear(&P->x);
39     Fp\_clear(&P->y);
40 \}
\end{DoxyCode}
Here is the caller graph for this function\+:
% FIG 2
\mbox{\Hypertarget{bn__efp_8h_a4b290a91bf913cf38dffee13f1db784b}\label{bn__efp_8h_a4b290a91bf913cf38dffee13f1db784b}} 
\index{bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}!E\+Fp\+\_\+\+E\+CA@{E\+Fp\+\_\+\+E\+CA}}
\index{E\+Fp\+\_\+\+E\+CA@{E\+Fp\+\_\+\+E\+CA}!bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}}
\subsubsection{\texorpdfstring{E\+Fp\+\_\+\+E\+C\+A()}{EFp\_ECA()}}
{\footnotesize\ttfamily void E\+Fp\+\_\+\+E\+CA (\begin{DoxyParamCaption}\item[{\hyperlink{struct_e_fp}{E\+Fp} $\ast$}]{A\+NS,  }\item[{\hyperlink{struct_e_fp}{E\+Fp} $\ast$}]{P1,  }\item[{\hyperlink{struct_e_fp}{E\+Fp} $\ast$}]{P2 }\end{DoxyParamCaption})}

Elliptiptic curve addition in \hyperlink{struct_e_fp}{E\+Fp} A\+NS = P1+\+P2 for BN and B\+LS curve


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em A\+NS} & -\/ output \\
\hline
\mbox{\tt in}  & {\em P1} & -\/ passed input pointer in \hyperlink{struct_e_fp}{E\+Fp} \\
\hline
\mbox{\tt in}  & {\em P1} & -\/ passed input pointer in \hyperlink{struct_e_fp}{E\+Fp} \\
\hline
\end{DoxyParams}


References E\+Fp\+\_\+clear(), E\+Fp\+\_\+\+E\+C\+D(), E\+Fp\+\_\+init(), and E\+Fp\+\_\+set().



Referenced by bls12\+\_\+2split\+\_\+\+G1\+\_\+scm(), and E\+Fp\+\_\+\+S\+C\+M().


\begin{DoxyCode}
162                                       \{
163     \textcolor{keywordflow}{if}(P1->infinity==1)\{
164         \hyperlink{bn__efp_8h_abb438750cc5bfec2da8cd2f3863a985f}{EFp\_set}(ANS,P2);
165         \textcolor{keywordflow}{return};
166     \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(P2->infinity==1)\{
167         \hyperlink{bn__efp_8h_abb438750cc5bfec2da8cd2f3863a985f}{EFp\_set}(ANS,P1);
168         \textcolor{keywordflow}{return};
169     \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(Fp\_cmp(&P1->x,&P2->x)==0)\{
170         \textcolor{keywordflow}{if}(Fp\_cmp(&P1->y,&P2->y)!=0)\{
171             ANS->infinity=1;
172             \textcolor{keywordflow}{return};
173         \}\textcolor{keywordflow}{else}\{
174             \hyperlink{bn__efp_8h_a9ba98cee075d39257ea190cbe340dec5}{EFp\_ECD}(ANS,P1);
175             \textcolor{keywordflow}{return};
176         \}
177     \}
178     
179     \hyperlink{struct_e_fp}{EFp} Tmp\_P1,Tmp\_P2;
180     \hyperlink{bn__efp_8h_a2b1c0fe61a09134e31640f1565a48ed1}{EFp\_init}(&Tmp\_P1);
181     \hyperlink{bn__efp_8h_abb438750cc5bfec2da8cd2f3863a985f}{EFp\_set}(&Tmp\_P1,P1);
182     \hyperlink{bn__efp_8h_a2b1c0fe61a09134e31640f1565a48ed1}{EFp\_init}(&Tmp\_P2);
183     \hyperlink{bn__efp_8h_abb438750cc5bfec2da8cd2f3863a985f}{EFp\_set}(&Tmp\_P2,P2);
184     \hyperlink{struct_fp}{Fp} tmp1,tmp2,lambda;
185     Fp\_init(&tmp1);
186     Fp\_init(&tmp2);
187     Fp\_init(&lambda);
188     
189     Fp\_sub(&tmp1,&Tmp\_P2.x,&Tmp\_P1.x);
190     Fp\_inv(&tmp1,&tmp1);
191     Fp\_sub(&tmp2,&Tmp\_P2.y,&Tmp\_P1.y);
192     Fp\_mul(&lambda,&tmp1,&tmp2);
193     Fp\_mul(&tmp1,&lambda,&lambda);
194     Fp\_sub(&tmp2,&tmp1,&Tmp\_P1.x);
195     Fp\_sub(&ANS->x,&tmp2,&Tmp\_P2.x);
196     Fp\_sub(&tmp1,&Tmp\_P1.x,&ANS->x);
197     Fp\_mul(&tmp2,&lambda,&tmp1);
198     Fp\_sub(&ANS->y,&tmp2,&Tmp\_P1.y);
199     
200     \textcolor{comment}{//clear}
201     Fp\_clear(&tmp1);
202     Fp\_clear(&tmp2);
203     Fp\_clear(&lambda);
204     \hyperlink{bn__efp_8h_a8d12aae9ceed0cf06fffc1dc2c2aae40}{EFp\_clear}(&Tmp\_P1);
205     \hyperlink{bn__efp_8h_a8d12aae9ceed0cf06fffc1dc2c2aae40}{EFp\_clear}(&Tmp\_P2);
206 \}
\end{DoxyCode}
Here is the call graph for this function\+:
% FIG 3
Here is the caller graph for this function\+:
% FIG 4
\mbox{\Hypertarget{bn__efp_8h_a9ba98cee075d39257ea190cbe340dec5}\label{bn__efp_8h_a9ba98cee075d39257ea190cbe340dec5}} 
\index{bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}!E\+Fp\+\_\+\+E\+CD@{E\+Fp\+\_\+\+E\+CD}}
\index{E\+Fp\+\_\+\+E\+CD@{E\+Fp\+\_\+\+E\+CD}!bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}}
\subsubsection{\texorpdfstring{E\+Fp\+\_\+\+E\+C\+D()}{EFp\_ECD()}}
{\footnotesize\ttfamily void E\+Fp\+\_\+\+E\+CD (\begin{DoxyParamCaption}\item[{\hyperlink{struct_e_fp}{E\+Fp} $\ast$}]{A\+NS,  }\item[{\hyperlink{struct_e_fp}{E\+Fp} $\ast$}]{P }\end{DoxyParamCaption})}

Elliptiptic curve doubling A\+NS = 2\mbox{[}P\mbox{]} in \hyperlink{struct_e_fp}{E\+Fp} for BN and B\+LS curve


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em A\+NS} & -\/ output \\
\hline
\mbox{\tt in}  & {\em P} & -\/ passed input pointer in \hyperlink{struct_e_fp}{E\+Fp} \\
\hline
\end{DoxyParams}


References E\+Fp\+\_\+clear(), E\+Fp\+\_\+init(), and E\+Fp\+\_\+set().



Referenced by bls12\+\_\+2split\+\_\+\+G1\+\_\+scm(), E\+Fp\+\_\+\+E\+C\+A(), and E\+Fp\+\_\+\+S\+C\+M().


\begin{DoxyCode}
129                              \{
130     \textcolor{keywordflow}{if}(Fp\_cmp\_zero(&P->y)==0)\{
131         ANS->infinity=1;
132         \textcolor{keywordflow}{return};
133     \}
134     
135     \hyperlink{struct_e_fp}{EFp} Tmp\_P;
136     \hyperlink{bn__efp_8h_a2b1c0fe61a09134e31640f1565a48ed1}{EFp\_init}(&Tmp\_P);
137     \hyperlink{bn__efp_8h_abb438750cc5bfec2da8cd2f3863a985f}{EFp\_set}(&Tmp\_P,P);
138     \hyperlink{struct_fp}{Fp} tmp1,tmp2,lambda;
139     Fp\_init(&tmp1);
140     Fp\_init(&tmp2);
141     Fp\_init(&lambda);
142     
143     Fp\_mul\_ui(&tmp1,&Tmp\_P.y,2);
144     Fp\_inv(&tmp1,&tmp1);
145     Fp\_mul(&tmp2,&Tmp\_P.x,&Tmp\_P.x);
146     Fp\_mul\_ui(&tmp2,&tmp2,3);
147     Fp\_mul(&lambda,&tmp1,&tmp2);
148     Fp\_mul(&tmp1,&lambda,&lambda);
149     Fp\_mul\_ui(&tmp2,&Tmp\_P.x,2);
150     Fp\_sub(&ANS->x,&tmp1,&tmp2);
151     Fp\_sub(&tmp1,&Tmp\_P.x,&ANS->x);
152     Fp\_mul(&tmp2,&lambda,&tmp1);
153     Fp\_sub(&ANS->y,&tmp2,&Tmp\_P.y);
154     
155     \textcolor{comment}{//clear}
156     Fp\_clear(&tmp1);
157     Fp\_clear(&tmp2);
158     Fp\_clear(&lambda);
159     \hyperlink{bn__efp_8h_a8d12aae9ceed0cf06fffc1dc2c2aae40}{EFp\_clear}(&Tmp\_P);
160 \}
\end{DoxyCode}
Here is the call graph for this function\+:
% FIG 5
Here is the caller graph for this function\+:
% FIG 6
\mbox{\Hypertarget{bn__efp_8h_a2b1c0fe61a09134e31640f1565a48ed1}\label{bn__efp_8h_a2b1c0fe61a09134e31640f1565a48ed1}} 
\index{bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}!E\+Fp\+\_\+init@{E\+Fp\+\_\+init}}
\index{E\+Fp\+\_\+init@{E\+Fp\+\_\+init}!bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}}
\subsubsection{\texorpdfstring{E\+Fp\+\_\+init()}{EFp\_init()}}
{\footnotesize\ttfamily void E\+Fp\+\_\+init (\begin{DoxyParamCaption}\item[{\hyperlink{struct_e_fp}{E\+Fp} $\ast$}]{P }\end{DoxyParamCaption})}

Initialize an \hyperlink{struct_e_fp}{E\+Fp} type structure


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P} & -\/ input P in \hyperlink{struct_e_fp}{E\+Fp}. \\
\hline
\end{DoxyParams}


Referenced by bls12\+\_\+2split\+\_\+\+G1\+\_\+scm(), bls12\+\_\+f\+\_\+ltp\+\_\+vtp\+\_\+for\+\_\+tate(), bls12\+\_\+ff\+\_\+ltt\+\_\+vtt\+\_\+for\+\_\+tate(), bls12\+\_\+generate\+\_\+\+G1\+\_\+point(), bls12\+\_\+\+Miller\+\_\+algo\+\_\+for\+\_\+opt\+\_\+ate(), bls12\+\_\+\+Miller\+\_\+algo\+\_\+for\+\_\+plain\+\_\+ate(), bls12\+\_\+\+Miller\+\_\+algo\+\_\+for\+\_\+tate(), bls12\+\_\+plain\+\_\+\+G1\+\_\+scm(), bls12\+\_\+\+Pseudo\+\_\+8\+\_\+sparse\+\_\+mapping(), E\+Fp\+\_\+\+E\+C\+A(), E\+Fp\+\_\+\+E\+C\+D(), and E\+Fp\+\_\+\+S\+C\+M().


\begin{DoxyCode}
31                      \{
32     Fp\_init(&P->x);
33     Fp\_init(&P->y);
34     P->infinity=0;
35 \}
\end{DoxyCode}
Here is the caller graph for this function\+:
% FIG 7
\mbox{\Hypertarget{bn__efp_8h_ace55a465b090ba75133b027626fb58e9}\label{bn__efp_8h_ace55a465b090ba75133b027626fb58e9}} 
\index{bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}!E\+Fp\+\_\+printf@{E\+Fp\+\_\+printf}}
\index{E\+Fp\+\_\+printf@{E\+Fp\+\_\+printf}!bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}}
\subsubsection{\texorpdfstring{E\+Fp\+\_\+printf()}{EFp\_printf()}}
{\footnotesize\ttfamily void E\+Fp\+\_\+printf (\begin{DoxyParamCaption}\item[{\hyperlink{struct_e_fp}{E\+Fp} $\ast$}]{P,  }\item[{char $\ast$}]{str }\end{DoxyParamCaption})}

Prints an \hyperlink{struct_e_fp}{E\+Fp} type structure


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P} & -\/ input P in \hyperlink{struct_e_fp}{E\+Fp}. \\
\hline
\mbox{\tt in}  & {\em str} & -\/ any string to print. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
42                                  \{
43     gmp\_printf(\textcolor{stringliteral}{"%s"},str);
44     \textcolor{keywordflow}{if}(P->infinity==0)\{
45         gmp\_printf(\textcolor{stringliteral}{"("});
46         Fp\_printf(&P->x,\textcolor{stringliteral}{""});
47         gmp\_printf(\textcolor{stringliteral}{","});
48         Fp\_printf(&P->y,\textcolor{stringliteral}{""});
49         gmp\_printf(\textcolor{stringliteral}{")"});
50     \}\textcolor{keywordflow}{else}\{
51         gmp\_printf(\textcolor{stringliteral}{"infinity"});
52     \}
53 \}
\end{DoxyCode}
\mbox{\Hypertarget{bn__efp_8h_a131fa3538790c33f2006d84b4a60f4e5}\label{bn__efp_8h_a131fa3538790c33f2006d84b4a60f4e5}} 
\index{bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}!E\+Fp\+\_\+rational\+\_\+point\+\_\+bls12@{E\+Fp\+\_\+rational\+\_\+point\+\_\+bls12}}
\index{E\+Fp\+\_\+rational\+\_\+point\+\_\+bls12@{E\+Fp\+\_\+rational\+\_\+point\+\_\+bls12}!bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}}
\subsubsection{\texorpdfstring{E\+Fp\+\_\+rational\+\_\+point\+\_\+bls12()}{EFp\_rational\_point\_bls12()}}
{\footnotesize\ttfamily void E\+Fp\+\_\+rational\+\_\+point\+\_\+bls12 (\begin{DoxyParamCaption}\item[{\hyperlink{struct_e_fp}{E\+Fp} $\ast$}]{P }\end{DoxyParamCaption})}

Generate rational point in \hyperlink{struct_e_fp}{E\+Fp} for B\+L\+S12 curve


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P} & -\/ passed input pointer in \hyperlink{struct_e_fp}{E\+Fp} and obtain genterated point \\
\hline
\end{DoxyParams}


Referenced by bls12\+\_\+generate\+\_\+\+G1\+\_\+point().


\begin{DoxyCode}
104                                      \{
105     \hyperlink{struct_fp}{Fp} tmp1,tmp2,tmp\_x;
106     Fp\_init(&tmp1);
107     Fp\_init(&tmp2);
108     Fp\_init(&tmp\_x);
109     gmp\_randstate\_t \hyperlink{bn__bls12__precoms_8h_adc6e5733fc3c22f0a7b2914188c49c90}{state};
110     gmp\_randinit\_default (state);
111     gmp\_randseed\_ui(state,(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long})time(NULL));
112     
113     \textcolor{keywordflow}{while}(1)\{
114         Fp\_set\_random(&P->x,state);
115         Fp\_mul(&tmp1,&P->x,&P->x);
116         Fp\_mul(&tmp2,&tmp1,&P->x);
117         Fp\_add\_mpz(&tmp\_x,&tmp2,curve\_parameters.curve\_b);
118         \textcolor{keywordflow}{if}(Fp\_legendre(&tmp\_x)==1)\{
119             Fp\_sqrt(&P->y,&tmp\_x);
120             \textcolor{keywordflow}{break};
121         \}
122     \}
123     
124     Fp\_clear(&tmp1);
125     Fp\_clear(&tmp2);
126     Fp\_clear(&tmp\_x);
127 \}
\end{DoxyCode}
Here is the caller graph for this function\+:
% FIG 8
\mbox{\Hypertarget{bn__efp_8h_a22397c097b95b8869032b55963d7ff2e}\label{bn__efp_8h_a22397c097b95b8869032b55963d7ff2e}} 
\index{bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}!E\+Fp\+\_\+rational\+\_\+point\+\_\+bn@{E\+Fp\+\_\+rational\+\_\+point\+\_\+bn}}
\index{E\+Fp\+\_\+rational\+\_\+point\+\_\+bn@{E\+Fp\+\_\+rational\+\_\+point\+\_\+bn}!bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}}
\subsubsection{\texorpdfstring{E\+Fp\+\_\+rational\+\_\+point\+\_\+bn()}{EFp\_rational\_point\_bn()}}
{\footnotesize\ttfamily void E\+Fp\+\_\+rational\+\_\+point\+\_\+bn (\begin{DoxyParamCaption}\item[{\hyperlink{struct_e_fp}{E\+Fp} $\ast$}]{P }\end{DoxyParamCaption})}

Generate rational point in \hyperlink{struct_e_fp}{E\+Fp} for BN curve


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P} & -\/ passed input pointer in \hyperlink{struct_e_fp}{E\+Fp} and obtain genterated point \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
79                                   \{
80     \hyperlink{struct_fp}{Fp} tmp1,tmp2,tmp\_x;
81     Fp\_init(&tmp1);
82     Fp\_init(&tmp2);
83     Fp\_init(&tmp\_x);
84     gmp\_randstate\_t \hyperlink{bn__bls12__precoms_8h_adc6e5733fc3c22f0a7b2914188c49c90}{state};
85     gmp\_randinit\_default (state);
86     gmp\_randseed\_ui(state,(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long})time(NULL));
87     
88     \textcolor{keywordflow}{while}(1)\{
89         Fp\_set\_random(&P->x,state);
90         Fp\_mul(&tmp1,&P->x,&P->x);
91         Fp\_mul(&tmp2,&tmp1,&P->x);
92         Fp\_sub\_mpz(&tmp\_x,&tmp2,curve\_parameters.curve\_b);
93         \textcolor{keywordflow}{if}(Fp\_legendre(&tmp\_x)==1)\{
94             Fp\_sqrt(&P->y,&tmp\_x);
95             \textcolor{keywordflow}{break};
96         \}
97     \}
98     
99     Fp\_clear(&tmp1);
100     Fp\_clear(&tmp2);
101     Fp\_clear(&tmp\_x);
102 \}
\end{DoxyCode}
\mbox{\Hypertarget{bn__efp_8h_a39968088354e07b3bff879ea6ce7eea3}\label{bn__efp_8h_a39968088354e07b3bff879ea6ce7eea3}} 
\index{bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}!E\+Fp\+\_\+\+S\+CM@{E\+Fp\+\_\+\+S\+CM}}
\index{E\+Fp\+\_\+\+S\+CM@{E\+Fp\+\_\+\+S\+CM}!bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}}
\subsubsection{\texorpdfstring{E\+Fp\+\_\+\+S\+C\+M()}{EFp\_SCM()}}
{\footnotesize\ttfamily void E\+Fp\+\_\+\+S\+CM (\begin{DoxyParamCaption}\item[{\hyperlink{struct_e_fp}{E\+Fp} $\ast$}]{A\+NS,  }\item[{\hyperlink{struct_e_fp}{E\+Fp} $\ast$}]{P,  }\item[{mpz\+\_\+t}]{scalar }\end{DoxyParamCaption})}

Elliptiptic Scalar Multiplication (S\+CM) in \hyperlink{struct_e_fp}{E\+Fp} A\+NS = \mbox{[}scalar\mbox{]}P for BN and B\+LS curve


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em A\+NS} & -\/ output \\
\hline
\mbox{\tt in}  & {\em P} & -\/ passed input pointer in \hyperlink{struct_e_fp}{E\+Fp} \\
\hline
\mbox{\tt in}  & {\em P1} & -\/ input integer \\
\hline
\end{DoxyParams}


References E\+Fp\+\_\+clear(), E\+Fp\+\_\+\+E\+C\+A(), E\+Fp\+\_\+\+E\+C\+D(), E\+Fp\+\_\+init(), and E\+Fp\+\_\+set().



Referenced by bls12\+\_\+plain\+\_\+\+G1\+\_\+scm().


\begin{DoxyCode}
208                                           \{
209     \textcolor{keywordflow}{if}(mpz\_cmp\_ui(scalar,0)==0)\{
210         ANS->infinity=1;
211         \textcolor{keywordflow}{return};
212     \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(mpz\_cmp\_ui(scalar,1)==0)\{
213         \hyperlink{bn__efp_8h_abb438750cc5bfec2da8cd2f3863a985f}{EFp\_set}(ANS,P);
214         \textcolor{keywordflow}{return};
215     \}
216     
217     \hyperlink{struct_e_fp}{EFp} Tmp\_P,Next\_P;
218     \hyperlink{bn__efp_8h_a2b1c0fe61a09134e31640f1565a48ed1}{EFp\_init}(&Tmp\_P);
219     \hyperlink{bn__efp_8h_abb438750cc5bfec2da8cd2f3863a985f}{EFp\_set}(&Tmp\_P,P);
220     \hyperlink{bn__efp_8h_a2b1c0fe61a09134e31640f1565a48ed1}{EFp\_init}(&Next\_P);
221     \textcolor{keywordtype}{int} i,length;
222     length=(int)mpz\_sizeinbase(scalar,2);
223     \textcolor{keywordtype}{char} binary[length];
224     mpz\_get\_str(binary,2,scalar);
225     
226     \hyperlink{bn__efp_8h_abb438750cc5bfec2da8cd2f3863a985f}{EFp\_set}(&Next\_P,&Tmp\_P);
227     \textcolor{keywordflow}{for}(i=1; i<length; i++)\{
228         \hyperlink{bn__efp_8h_a9ba98cee075d39257ea190cbe340dec5}{EFp\_ECD}(&Next\_P,&Next\_P);
229         \textcolor{keywordflow}{if}(binary[i]==\textcolor{charliteral}{'1'})\{
230             \hyperlink{bn__efp_8h_a4b290a91bf913cf38dffee13f1db784b}{EFp\_ECA}(&Next\_P,&Next\_P,&Tmp\_P);
231         \}
232     \}
233     
234     \hyperlink{bn__efp_8h_abb438750cc5bfec2da8cd2f3863a985f}{EFp\_set}(ANS,&Next\_P);
235     
236     \hyperlink{bn__efp_8h_a8d12aae9ceed0cf06fffc1dc2c2aae40}{EFp\_clear}(&Next\_P);
237     \hyperlink{bn__efp_8h_a8d12aae9ceed0cf06fffc1dc2c2aae40}{EFp\_clear}(&Tmp\_P);
238 \}
\end{DoxyCode}
Here is the call graph for this function\+:
% FIG 9
Here is the caller graph for this function\+:
% FIG 10
\mbox{\Hypertarget{bn__efp_8h_abb438750cc5bfec2da8cd2f3863a985f}\label{bn__efp_8h_abb438750cc5bfec2da8cd2f3863a985f}} 
\index{bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}!E\+Fp\+\_\+set@{E\+Fp\+\_\+set}}
\index{E\+Fp\+\_\+set@{E\+Fp\+\_\+set}!bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}}
\subsubsection{\texorpdfstring{E\+Fp\+\_\+set()}{EFp\_set()}}
{\footnotesize\ttfamily void E\+Fp\+\_\+set (\begin{DoxyParamCaption}\item[{\hyperlink{struct_e_fp}{E\+Fp} $\ast$}]{A\+NS,  }\item[{\hyperlink{struct_e_fp}{E\+Fp} $\ast$}]{P }\end{DoxyParamCaption})}

Sets an \hyperlink{struct_e_fp}{E\+Fp} type structure


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em A\+NS} & -\/ output A\+NS is set as P in \hyperlink{struct_e_fp}{E\+Fp}. \\
\hline
\mbox{\tt in}  & {\em P} & -\/ input P in \hyperlink{struct_e_fp}{E\+Fp}. \\
\hline
\end{DoxyParams}


Referenced by bls12\+\_\+2split\+\_\+\+G1\+\_\+scm(), bls12\+\_\+f\+\_\+ltp\+\_\+vtp\+\_\+for\+\_\+tate(), bls12\+\_\+ff\+\_\+ltt\+\_\+vtt\+\_\+for\+\_\+tate(), bls12\+\_\+\+Miller\+\_\+algo\+\_\+for\+\_\+tate(), bls12\+\_\+\+Pseudo\+\_\+8\+\_\+sparse\+\_\+mapping(), E\+Fp\+\_\+\+E\+C\+A(), E\+Fp\+\_\+\+E\+C\+D(), and E\+Fp\+\_\+\+S\+C\+M().


\begin{DoxyCode}
55                              \{
56     Fp\_set(&ANS->x,&P->x);
57     Fp\_set(&ANS->y,&P->y);
58     ANS->infinity=P->infinity;
59 \}
\end{DoxyCode}
Here is the caller graph for this function\+:
% FIG 11
\mbox{\Hypertarget{bn__efp_8h_a9a4499bd470e37678fe8558f0ea81e91}\label{bn__efp_8h_a9a4499bd470e37678fe8558f0ea81e91}} 
\index{bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}!E\+Fp\+\_\+set\+\_\+mpz@{E\+Fp\+\_\+set\+\_\+mpz}}
\index{E\+Fp\+\_\+set\+\_\+mpz@{E\+Fp\+\_\+set\+\_\+mpz}!bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}}
\subsubsection{\texorpdfstring{E\+Fp\+\_\+set\+\_\+mpz()}{EFp\_set\_mpz()}}
{\footnotesize\ttfamily void E\+Fp\+\_\+set\+\_\+mpz (\begin{DoxyParamCaption}\item[{\hyperlink{struct_e_fp}{E\+Fp} $\ast$}]{A\+NS,  }\item[{mpz\+\_\+t}]{A }\end{DoxyParamCaption})}

Sets an \hyperlink{struct_e_fp}{E\+Fp} type structure


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em A\+NS} & -\/ output A\+NS is set as \hyperlink{struct_e_fp}{E\+Fp}. \\
\hline
\mbox{\tt in}  & {\em UI} & -\/ input in G\+MP mpz\+\_\+t \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
67                                   \{
68     Fp\_set\_mpz(&ANS->x,A);
69     Fp\_set\_mpz(&ANS->y,A);
70     ANS->infinity=0;
71 \}
\end{DoxyCode}
\mbox{\Hypertarget{bn__efp_8h_abdf2bfc544a61322457518297de393c4}\label{bn__efp_8h_abdf2bfc544a61322457518297de393c4}} 
\index{bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}!E\+Fp\+\_\+set\+\_\+neg@{E\+Fp\+\_\+set\+\_\+neg}}
\index{E\+Fp\+\_\+set\+\_\+neg@{E\+Fp\+\_\+set\+\_\+neg}!bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}}
\subsubsection{\texorpdfstring{E\+Fp\+\_\+set\+\_\+neg()}{EFp\_set\_neg()}}
{\footnotesize\ttfamily void E\+Fp\+\_\+set\+\_\+neg (\begin{DoxyParamCaption}\item[{\hyperlink{struct_e_fp}{E\+Fp} $\ast$}]{A\+NS,  }\item[{\hyperlink{struct_e_fp}{E\+Fp} $\ast$}]{P }\end{DoxyParamCaption})}

Negate \hyperlink{struct_e_fp}{E\+Fp}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em A\+NS} & -\/ output pointer. \\
\hline
\mbox{\tt in}  & {\em UI} & -\/ input pointer in \hyperlink{struct_e_fp}{E\+Fp} \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
73                                  \{
74     Fp\_set(&ANS->x,&P->x);
75     Fp\_set\_neg(&ANS->y,&P->y);
76     ANS->infinity=P->infinity;
77 \}
\end{DoxyCode}
\mbox{\Hypertarget{bn__efp_8h_a20e5f75e7bf655defd447099e8bbc3e5}\label{bn__efp_8h_a20e5f75e7bf655defd447099e8bbc3e5}} 
\index{bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}!E\+Fp\+\_\+set\+\_\+ui@{E\+Fp\+\_\+set\+\_\+ui}}
\index{E\+Fp\+\_\+set\+\_\+ui@{E\+Fp\+\_\+set\+\_\+ui}!bn\+\_\+efp.\+h@{bn\+\_\+efp.\+h}}
\subsubsection{\texorpdfstring{E\+Fp\+\_\+set\+\_\+ui()}{EFp\_set\_ui()}}
{\footnotesize\ttfamily void E\+Fp\+\_\+set\+\_\+ui (\begin{DoxyParamCaption}\item[{\hyperlink{struct_e_fp}{E\+Fp} $\ast$}]{A\+NS,  }\item[{unsigned long int}]{UI }\end{DoxyParamCaption})}

Sets an \hyperlink{struct_e_fp}{E\+Fp} type structure


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em A\+NS} & -\/ output A\+NS is set an unsigned long int. \\
\hline
\mbox{\tt in}  & {\em UI} & -\/ input in unsigned long int \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
61                                               \{
62     Fp\_set\_ui(&ANS->x,UI);
63     Fp\_set\_ui(&ANS->y,UI);
64     ANS->infinity=0;
65 \}
\end{DoxyCode}
